<!DOCTYPE html>
<html>
<head>
	<title>GeoMixer Vector Layer Example</title>
	<meta charset="utf-8" />
    <style>
    </style>

	<link rel="stylesheet" href="main.css" />
    
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone.js"></script>
    
    <script src="../../Thorax/thorax.js"></script>
    
    <script src="../LayersTree.js"></script>
    <script src="LayersTreeView.js"></script>
    <script src="TreeExample.js"></script>
    <script>
        $(function() {
            var layersTree = new LayersTreeNode({content: treeExample.Result});
            var layersTreeView = new LayersTreeNodeView({model: layersTree});
            layersTreeView.appendTo($('#tree-placeholder'));
            
            var logs = new Thorax.Collection();
            var logsView = new Thorax.View({
                collection: logs,
                template: Handlebars.compile(
                    '<div>Logs</div>' + 
                    '<div>{{#collection}}' +
                        '{{name}} {{#if visible}}visible{{else}}hidden{{/if}}' +
                    '{{/collection}}</div>')
            })
            logsView.appendTo($('#log'));
            
            layersTree.on('childChange', function(node) {
                logs.add(new Thorax.Model({
                    name: node.get('properties').title, 
                    date: new Date(),
                    visible: node.get('visible')
                }), {at: 0});
            })
        })
    </script>    
</head>
<body>
	<div id="tree-placeholder"></div>
    <div id="log"></div>
</body>
</html>